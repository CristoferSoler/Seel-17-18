#M 5.19 Use of sendmail security mechanisms
Responsible for initiation: Administrator

Responsible for implementation: Administrator

Since the transmission of e-mails is probably the most common application in networks, the responsible processes are of particular importance and one of the most frequent points of attack in a system. In addition, these processes often have the suid bit set and belong to a privileged user (eg root or bin). An error in sendmail was z. B. one of the ways that the internet worm has spread.

* When you start sendmail, you can specify a large number of options that would cause security issues if they ran with root privileges. If sendmail can be called by any user, it should therefore be checked whether it ignores the set suid bit when starting with one of these options and runs with the user's UID. To avoid security issues, the administrator should ensure that sendmail can only be started by unprivileged users with the following options when the suid root bit is set: 7, b, c, d, e, E, i, j, L, m , o, p, r, s and v.
* Due to the historical deficiencies of the sendmail program, the most recent version of the program must always be used. Information about the current versions is given in the sections M.2.35 Obtaining information about security gaps of the system such as BSI, CERT, DFN-CERT.
* The sendmail process can not be run in debug mode, otherwise it will be possible to gain root privileges. You can test this by typing the telnet localhost 25 command, where localhost can be the machine name to check, and 25 is the port number used to address the sendmail process. The computer or the sendmail process then logs with Trying 123.45.67.8 ... Connected to xxx.yy.de. Escape character is '^]'. 220 xxx Sendmail 4.1 / SMI-4.1 ready at Wed, 13 Apr 94 10:04:43 +0200 If you enter the command debug, showq or in very old versions wizard, the process should be rejected with 500 Command unrecognized. The connection can be ended again with the command quit.
* The commands vrfy and expn may not be available, as they output the associated login name to a mail name so that the appropriate password can then be found out by trying on it. For version 8 of sendmail, these commands can be For example, turn off the p (privacy) option at startup. Whether these commands are available, can be determined as described in the previous point, so z. By entering the command vrfy useralias.
* The configuration file sendmail.cf should be owned by root and be readable and writable only for root. The same applies to the directories above, otherwise a new sendmail.cf file can be created by simply renaming these directories.
* Specifying executable programs or files as valid recipient or sender addresses must be prevented by configuring sendmail.cf or restricted to specific, safe programs and files by appropriate action ,
* The F command (eg FX / path [^ #]) that defines classes should only be used in the configuration file (sendmail.cf) to read files that are read system-wide otherwise it may be possible for security-relevant information to become freely available from protected files. The program form of the F-command (eg FX | / tmp / prg) should not be used!
* When defining the delivery agent (eg Mlocal), only absolute paths must be specified (eg P = / bin / mail). In addition, the S (suid) flag should only be set if the related security issues have been resolved.
* Any file sendmail could write to, such as: For example, sendmail.st for a statistic should only be writable by root and should be in root-only directories. The same applies to files that are evaluated by sendmail, such as: For example: include: in mailing lists.
* Privileged users like bin or root should not have a .forward file. If the user or group write permissions for this file are set incorrectly, or if a user succeeds in entering a privileged group, he can create a shell with the privileged user ID. For normal users, the. forward file can only be written by the owner and must be located in a directory owned by the owner.If a home directory must be describable system-wide, such. For example, uucp can be used to prevent the creation of a harmful .forward file by creating a directory named .forward, the rights 000 and the owner root, and a file in that folder also with the rights 000 and the owner root, so that no one except root can change or delete this file. The homedirectory of uucp should then also be root and be provided with the sticky bit (t). An analogous procedure is also recommended for other configuration files (eg .login, .cshrc) in system-wide writable directories.
* From the alias file every executable program should be removed, especially uudecode. In addition, the alias file and the associated database root should be owned and described only for root.
* It must be noted that any received mail may be misleading. This can be done either in the mail queue or by logging in to port 25. The former can be avoided if the mail queue directory belongs to root and has the rights 0700. The queue files should have authorization 0600. The change of an e-mail during its transport can not be avoided, so that the users must be informed that, for For example, an email from root asking you to change your password may be forfeited.




