#M 4.454 Protection against unauthorized use of web services
Responsible for initiation: Responsible for the individual applications, Head of IT

Responsible for implementation: Administrator, IT Manager

In order to ensure that web services can only be used by authorized parties, it is necessary to provide specific requirements for the authentication and authorization of individual users or clients. These requirements must be realized within the framework of a carefully selected authentication and authorization model by means of one or a combination of several available WS standards. This ensures the restriction and control of individual accesses to the web service. Which web service standards can be used for the implementation of a suitable authentication and authorization is described in more detail in the measures M 4.456 Authentication for Web Services and M 4.455 Authorization for Web Services.

In order to aggravate attacks on a web service that, in the worst case scenario, could circumvent the authorization system and thus allow unauthorized access to confidential data or valuable functions, additional measures should be taken against brute force Attacks or other automated attacks on web services. Automated attacks are characterized by a high number of access attempts within a short period of time. Highly frequented requests (for example for guessing passwords) should be recognized by fixed thresholds and lead to appropriate responses (alerting of persons responsible, blocking of access). Such thresholds may relate, for example, to the number of accesses, mis-registrations, the amount of data transferred, or the size of the transmitted XML messages. In the case of a detected attempted attack, a temporary blocking of access can take place. An alternative to blocking access is the incremental delay of responses (that is, an increasing delay in each failed attempt) that effectively slows down automated attacks.

When setting thresholds, care must be taken to ensure that legitimate service users (clients and their users, other web services) are not restricted in the functionality and operation of the web service.

In principle, it should always be ensured that only authorized systems or users can access the web service. A firewall can ensure that only authorized IP addresses or IP address blocks can access the Web service. In closed environments, this whitelisting approach lends itself. If a web service is operated that is to be accessible from the Internet (for example, APIs for free use by third parties), a blacklisting approach is recommended. Blocking known IP addresses, which can be assigned to spam servers, for example, can ensure that access is excluded from systems that must be regarded as malicious. Even unauthorized access from certain regions or countries can be prevented by such revocation lists. Alternatively, the blocking of IP address blocks can also be initiated directly at the provider. An appropriate configuration of the firewall can also be used to ensure that frequently occurring calls from an IP address range or from a single IP address are limited in order to counteract a potential denial-of-service attack.

Another way to limit access to a web service for authorized users is to use a VPN. For example, a site-to-site VPN can ensure that only a select group of business partners can access the web service while maintaining confidentiality and integrity. Further information on using a VPN can be found in the B 4.4 VPN block. A VPN supports the protection of the web service, since no external brute force attacks on the web service can be carried out if it can only be reached from an internal network and thus not exposed on the internet.

Web services are often designed to be accessible both internally and externally (for example, through business partners), with access to different functions. For example, external users may only be able to place an order, while internal users should also be able to manage and process the orders received. Often, these different functions are offered through the same web service endpoint. However, since all functions can be called up via the same endpoint, an external attacker can obtain call points of the internal functions by reading the WSDL file or other methods of obtaining information in order to manipulate or read out data. For this reason, when implementing the web service care should be taken to ensure that the provision of functions for internal and external callers does not take place on the same endpoint. Ideally, the different web service endpoints are on different systems. By separating the associated URLs then a fine granular control on the web service can be achieved through a firewall, since the web service is invoked by different URLs and ports, or even only from certain networks.

Unless it is intended to be able to access certain operations, the description of the XML structure (schema) for the service call may also be modified to remove the undesired operations. If a request is made that contains an operation removed from the schema, it will be identified as invalid during validation of the XML request against the schema and will be rejected accordingly.

Access restriction to a web service over authentication and authorization of service users may prove ineffective if the attack shows its effect before the mechanisms of access control come into effect. For this reason, an adequate validation of the entire message must be carried out in advance, before the web service is allowed to process it further. This process is also known as schema validation. Schema validation ensures that messages and attacks that differ from the defined schema are prevented. This means that the scheme should be as restrictive as possible, meaning that only a limited amount of XML formats may be available to use the service. In schema validation, it is therefore necessary to restrict the schema so that messages with known attack patterns are excluded. In addition, it is necessary to examine the message for certain strings that may be used for injection attacks (see G 5.174 Injection attacks).

Furthermore, the schemes of a web service must be adapted so that only messages can be processed up to a certain size. The processing of a high-level message can use up the resources of the processing system and thus lead to a loss of performance or failures. When limiting the message size, you must ensure that no unrestricted message parts can be processed that have the following characteristics:

* xsd: any,
* xsd: anyType,
* xsd: anySimpleType,
* recursive definition of elements or types,
* unlimited lists.


The validation of a schema can either be done on an XML gateway or directly on the system that provides the web service. The decision as to where the validation is to take place must already be made during the planning phase, as this can also have effects on the overall architecture.



