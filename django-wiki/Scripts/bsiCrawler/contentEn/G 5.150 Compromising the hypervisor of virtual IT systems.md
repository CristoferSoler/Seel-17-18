#G 5.150 Compromising the hypervisor of virtual IT systems
The hypervisor is the central component of a virtualization server, controlling all virtual machines running on this virtualization server. It allocates processor and memory resources and distributes the available computing time to the virtual machines. It also manages the access of the virtual IT systems to the network and storage resources. A successful attack on this component means loss of control over all virtual IT systems running in the context of this hypervisor. An attack on the hypervisor can essentially be done as follows:

* Manipulation of the CPU registers that control the virtualization capabilities of processors with integrated virtualization support. By means of such attacks, it can be determined, for example, whether the attacker is in a virtual environment. For some virtualization products, certain processor commands can virtualize the hypervisor itself and thus bring it under the control of a malicious program. This is even possible from a virtual IT system.
* Exploit a bug in the implementation of the resources provided by the hypervisor to the IT virtual systems. This can for example concern emulated network cards, mass storage devices or graphics cards. Some virtualization products also emulate core components such as processor and memory. The device emulations are used by the virtual IT systems to leverage the corresponding features of the hypervisor or host operating system.
* As a central component, the hypervisor handles a number of safety-critical functions of a virtualization solution. If an attacker succeeds in compromising the hypervisor, the secure operation of the respective virtual IT systems and the relevant virtualization servers is greatly endangered. Attackers can try to manipulate or disrupt virtual IT systems in this way. Under certain circumstances, even confidential information can reach unauthorized persons. Weaknesses in the hypervisor product used can therefore entail considerable risks for information processing.
* Some virtualization systems also include functions for communication between the hypervisor and the virtual IT systems. These are usually implemented by guest tools that are installed in the virtual IT system. To enable communication between the guest tools and the hypervisor, each virtual IT system has a communication channel for the guest tools to the hypervisor. For example, in virtual IT systems based on the products of the manufacturer VMware, there exists a special DMA channel which opens such a channel when the specific processor registers are loaded with specific values. This way can not be used exclusively by the guest tools but also by malicious programs. If an attacker can occupy this communication channel, he or she has the option of exploiting security holes or design threads of the hypervisor in order to gain control over the hypervisor or to execute its own code in the context of the hypervisor. This allows the attacker to gain control of other virtual IT systems. Since the hypervisor monitors and controls all functions of a virtual IT system, processor functions or main memory contents of the virtual IT system can be directly manipulated via the hypervisor in order to introduce malicious programs into the virtual IT system. This does not necessarily require exploitable security vulnerabilities in the virtual IT system attacked by the hypervisor.




