#G 5.149 Abusive use of guest tools in virtual IT systems
For many virtualization products so-called guest tools are installed in the virtual IT systems. On the one hand, these guest tools can be used to provide the necessary device drivers for virtual or emulated devices such as network cards, hard disks or graphics cards for operating system virtualization. On the other hand, these tools within the virtual IT systems will install programs to communicate with the hypervisor or host operating system, increase the performance of the virtual IT system, and simplify the deployment of new virtual IT systems. With the help of the guest tools, the virtual IT systems can also be monitored. For example, the hypervisor or host operating system monitors the availability and performance of the guest.

The guest tools are often executed with very high privileges because of their system-related function. Often they run in context and thus with the rights of the operating system kernel of the virtual machine.

Features such as overbooking of memory or mass storage for virtual IT systems are coordinated between the hypervisor and the virtual IT system by the guest tools. These features add significant value to virtualization technology in data center operations.

Some virtualisation products specialized in software development still provide an option for the comfortable construction of complex test scenarios. This is often also implemented or supported via the guest tools. For this, the guest tools have interfaces for transferring script files to virtual IT systems. These scripts can then also be executed via the guest tools in the virtual IT system. All scripting languages ??available in the virtual IT system can be used. The start of the scripts can be initiated either at system startup, when a user logs in or at any other time. The interfaces typically do not require a network connection between the guests, but are provided through the hypervisor or host operating system.

These interfaces for scripts can be exploited by an attacker to establish unwanted and unconventional communication across multiple virtual IT systems. In doing so, the attacker transmits the data via the interface for transporting script files.

Furthermore, it is possible for an attacker to use the virtualization products described for software development to transfer their own script files from one virtual IT system to another virtual IT system using the guest tools. These can be executed with the rights with which the guest tools run. Due to the far-reaching authorization of the guest tools, this is particularly critical because any actions in the guest concerned can be executed. For example, malicious programs can be started, users created, group memberships changed or the configuration of the operating system of the virtual IT system manipulated.



## Examples 
* A system house processes software development orders for different customers. For this purpose, the system house operates a virtualisation environment specialized in development tasks, since comprehensive test scenarios have to be developed for the development of client-server applications. The test systems for these scenarios are provided via several templates for different virtual servers and clients, which are copied as needed and adapted to the respective test scenario. Due to the bad order situation of the system house, some developers have to be dismissed. One of the dismissed developers wants to get rid of his dismissal and develops a script that resets a virtual test system over and over again to the original state of the template as soon as a user logs on to the virtual system for the second time. It looks as if the user who logged in had triggered the reset process. In fact, this script is injected into the test system by the virtualization software each time it is launched for the second time. In addition, the script independently transmits a virtualization function to each virtual test system running in the virtual infrastructure. The system house managers suspect a worm infestation of their systems and entrust an IT consulting firm with the performance of a network analysis. to determine the cause of the problem. However, the consulting firm can not detect any incidents in the network of the system house. Only by accident, one of the developers noticed the attack on the test environment by his former colleague. The troubleshooting and the disruption of the test operation tied up considerable human resources and missed deadlines. This caused further damage to the already financially weak system house.
* A service provider runs a web server farm for multiple customers. To save hardware costs, he has virtualized the web server. In doing so, he provides customers with much more main memory for their virtual systems than is actually available in the virtual infrastructure. Since the customers 'web servers are usually underutilized, there are no noticeable performance restrictions in the virtual systems. One of the customers' web servers is now the victim of a denial of service attack. At the same time, this virtual IT system consumes a lot of main memory. However, this storage is not free in the physical virtualization server running the virtual web server, but is shared by other virtual web servers. In order to make this memory available to the attacked system, it must be released by other virtual IT systems. The hypervisor of the virtualization server thus shortens main memory for all other virtual web servers under its control. As a result, the response times of the virtual web server increase sharply. In some cases, there is a connection abort, so that the virtual web server, which was not directly the target of the DoS attack, are no longer available.




