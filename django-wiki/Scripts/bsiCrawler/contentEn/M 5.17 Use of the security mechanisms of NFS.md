#M 5.17 Use of the security mechanisms of NFS
Responsible for Initiation: Administrator, IT Security Officer

Responsible for implementation: Administrator

NFS (Network File System) allows the sharing of files on a server from all computers (clients), which are integrated in the same network and have been granted rights on the server. Each server can also be operated as a client and vice versa, so that it must be ensured that each computer only works with the functionality provided for it. So it is z. B. It is not necessary to mountd the mount daemon or start the NFS daemon nfsd on an NFS client.

* On an NFS server, every file system or directory that can be mounted by other computers must be entered in a file (eg / etc / exports or / etc / dfs / dfstab). For them, the following must apply: Only file systems that are absolutely necessary should be exported. With the keywords root and access, the computers can be specified exactly for which file systems should be released for export. If the specification of special computers is missing, the file system is released for all computers, which must not happen under any circumstances! For file systems that are only to be read, and this includes all executable files, the option ro Normally, the user number of the system administrator (UID 0) is converted to the number of the user nobody (UID -2 or 65534) for NFS requests, so that files with the UID 0 via NFS are not accessed can be. This does not apply to files belonging to other privileged users, such as: B. bin or daemon, which also in connection with the division of the administration activities (M 2.32 establishment of a limited user environment) must be considered, d. H. File systems containing files of these users may not be exported. Since each computer in the network can accept any IP and z. For example, if every PC user has DRO root privileges, then root should not be turned off on nobody, and it should be ensured that a nobody: *: - 2: -2: anonymous user :: entry in / etc / passwd exists and is effective. In this context, it must also be noted that any user who has root privileges on a network computer (eg as a PC user) can also accept any group ID via NFS, so that no exported directory and no exported file have group write permissions should possess and read and execute rights only insofar as this is It should also be noted that not only individual files but all the directories above must be protected! The anon = -1 option should be used to prevent anonymous queries. Anon = 0 (root) should never be used, as it allows every user to access files with root privileges.
* In files such. For example, / etc / fstab or / etc / vfstab are the file systems entered by a command such. Mount -a or mountall can be mounted. Under certain circumstances, this can also happen without a query at boot time. This file must therefore be checked in good time for correctness.
* / etc / exports and / etc / fstab (or analog files on other systems) are system files that only the system administrator can access.
* File systems to be exported should be set up on a separate disk or partition so that B. the unauthorized writing the system disk is prevented by a user from another computer.
* When mounting exported file systems, the nosuid option must be used to prevent the execution of suid programs on the client.
* If possible, the NFS daemon should be configured to automatically verify the port numbers to ensure that packets are accepted only from the privileged ports 0-1023.
* To mark files, so-called file handles are used between client and server, which can be easily guessed. They should therefore be randomized using the fsirand program.
* If present, SECURE-NFS should be used so that the data is encrypted. The following steps are important: Generating keys for all NFS users, deleting the public key for the user nobody, on the NIS master server rpc.ypupdated must not be running, transfer of the public key map on all computers, before SECURE-NFS is started, use of keylogin and keylogout to generate private keys when logging in and out, on each client must run the keyserv daemon, when mounting the option secure must be used, the clocks at all Computers must be synchronized because the transmitted packets are timestamped to prevent replaying of messages.




