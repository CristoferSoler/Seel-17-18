#M 4.146 Safe operation of Windows client operating systems
Responsible for initiation: IT security officer, IT manager

Responsible for implementation: Administrator, IT Manager

After installation and initial configuration in accordance with the previously planned Windows concepts and security guidelines, the operation of Windows systems usually takes place in the network. The security of such a network depends, on the one hand, on the set configuration parameters. On the other hand, it is also mainly determined by the type of configuration changes that must be made during operation. In particular side effects are to be taken into account, which may inadvertently lead to security gaps.

The Windows client versions provide a set of tools and mechanisms that can help administrators maintain the security of a running system:

* Windows File Protection (WFP) or Windows Resource Protection (WRP) is a Windows system mechanism that ensures that system files remain unchanged in their original state. The mechanism uses two components: the so-called SystemFileChecker (sfc.exe), which checks the system files, for example at system startup, for their integrity and replaces changed files with cached original files. Furthermore, there is a monitoring mechanism that replaces system files with the original version after attempting to write. The mechanism can also be configured to keep the modified file after a confirmation. The configuration is done by sfc.exe via the command line:


* Windows XP:
* sfc / SCANNO: immediately checks all protected system files.sfc / SCANONCE: Checks all protected system files once at the next reboot. sfc / SCANBOOT: Checks all protected system files at each Start.sfc / REVERT: Sets the mechanism back to the default settings. Back.sfc / PURGECACHE: Clears the file cache.


* As of Windows Vista:
* sfc / SCANNOW: Checks the integrity of all protected system files and fixes files with problems if needed. / VERIFYONLY: Checks the integrity of all protected system files. There is no repair.sfc / SCANFILE: Checks the integrity of the specified file and repairs the file if problems are found. A complete path must be specified. sfc / VERIFYFILE: Checks the integrity of the specified file. There is no repair.sfc / OFFBOOTDIR: Specifies the location of the offline startup directory for offline repairs.sfc / OFFWINDIR: Specifies the location of the offline Windows directory for offline repairs.To perform the above steps Administrators rights are required.
* Windows XP introduced automatic system recovery. This mechanism can be used to restore a previous system state, for example, when a software installation fails and the system gets into an unstable state. Depending on local circumstances, and especially on the software distribution strategy implemented, the use of automatic system recovery in, for example, the test environment may be advantageous. Windows Vista provides with Control Panel | Back Up and Restore and the Restore the entire computer from an image of Windows Complete PC Backup and Restore two options for recovering a damaged system. As of Windows 7, these settings (in the desktop view) can be found under the following path: Control Panel | Recovery | System Restore Open System restores may only be performed by responsible administrators. The configuration of the restored system must be checked for compliance with applicable security policies, so as not to endanger the security of the information network. It is particularly important to ensure that no critical patches, updates or settings are reset. These may need to be reinstalled and configured.
* Windows includes tools for configuring the security settings of Windows client machines with the command-line security editor secedit.exe and the MMC Snap-in Security Configuration and Analysis. This security configuration can also be stored in a database against which a computer can be tested for conformance. To do this, first create a database using the MMC Snap-in Security Configuration and Analysis (open the operation / database, enter new or existing database name). This can be initialized with a security template (.inf file, see MMC Snap-in Security Templates). By analyzing process / computer now and configuring process / system now an analysis or configuration of the system can be made according to the settings of the database. The database itself is in file form (.sdb file) and can be transferred to other systems. However, the statements in the case of deviations from access rights at file or registry level are not very helpful since only the deviation is documented, not however, which access rights deviate.
* The security settings of a Windows client are usually set by the use of Group Policy or the settings contained in an object when operating in a domain. In this way, the security settings can also be managed efficiently and centrally for large Windows networks. Changes to Group Policy Objects (GPO) settings take place centrally on a domain controller and are then distributed to the affected computers. The GPO mechanism can be configured to periodically update the GPO settings so that the changed settings can take effect (see also M 2.231 Group Policy Planning under Windows and M 2.326 Group Policy Planning for Clients from Windows XP).
* The security of system access can be increased by using a smart card-based login. Authentication then does not take place via a user name and a possibly weak password, but via a certificate which is stored on a physical chip card. Windows can be configured to log in both by entering username and password and via a smart card, or by smart card only. In general, only Microsoft-compliant certificates can be used as well as chip cards that are supported by Windows operating systems. With the introduction of Windows 8 and Windows Server 2012, it is possible to store such certificates on virtual smart cards. These simulate the functionality of a physical chip card and use the Trusted Platform Module (TPM), which must be integrated in the respective IT system. In this variant, it should be noted that such a smart card is always connected to the system (for example, if the device is stolen then the device is also in the possession of the thief). More secure here is the use of a real second factor for the authentication. Another way to deny system access to unauthorized persons is to use hard-disk encryption and authentication of the user before starting the operating system.
* When using cryptographic functions on the clients (hard-disk encryption, other encryption and signature procedures), special attention must be paid to securing the cryptographic keys against unauthorized access. On the one hand, storing the keys in the TPM offers a high degree of protection, but on the other hand, it couples the keys to the system used, so that a loss due to hardware defects threatens.


The security of an information network is always based on the physical security of the IT systems and network components. This must be ensured for the operation of a Windows client system. For the safe operation of a Windows client system, the following should generally be considered:

* The security of Windows depends essentially on the security of the Active Directory. The information contained here must on the one hand be protected against unauthorized change and on the other hand kept consistent. This requires particular care in the event of changes. In the context of security planning, it is urgently recommended not only to set values ??or value ranges for parameters, but also to define internal or administrative processes that are suitable for implementing the specified security policy. For example, it should be decided which steps should be performed when deleting or creating a new user account so that the necessary changes are carried out correctly. Further information on the secure operation of Windows clients in an Active Directory is described in B 5.16 Active Directory.


In addition to the security of the Active Directory and the system security, which is determined by the parameters defined in the Active Directory, the security of important system services must also be ensured. The security of DNS, WINS, DHCP, RAS and Kerberos plays a particularly important role here. Here, too, changes must be made to ensure that the applicable and defined safety guidelines are not violated. Information on configuring these services can be found in M 4.246 Configuring System Services on Clients as of Windows XP and the actions referenced therein.

* For the management of a Windows client system, the so-called snap-ins of the Microsoft Management Console (MMC snap-ins) are available as standard. MMC snap-ins represent management modules that can be integrated into the MMC via a standardized interface. Access to the various MMC snap-ins must therefore be regulated. Normal users should generally be denied access to system administration tools. However, the exception here is the MMC Snap-in for managing certificates, which must also be used by normal users to manage their own certificates. Access to the individual MMC snap-ins can be regulated in a granular way via GPO settings.
* The administrative tools to access the local registry of a machine (regedt32 and regedit) should not be accessible to ordinary users. This can also be achieved by GPO settings (see M 4.75 Registry protection under Windows systems).
* The security of a Windows network depends on many factors. In particular, security gaps can arise due to additional applications that are either configured incorrectly or contain programming errors. Often problems arise only through the joint operation of several applications. For this reason, tests should be carried out prior to the introduction of a new application to give an initial indication as to whether obvious problems exist. However, complete security can not be achieved, especially since the test for errors caused by side effects in other applications is difficult and extremely expensive.
* Even if changes are made carefully and in compliance with all precautionary measures, the existence of security gaps in a complex system can never be completely ruled out. For this reason, a suitable system monitoring should always take place (see also M 4.148 Monitoring a Windows 2000 / XP system and M 4.344 Monitoring Windows systems as of Windows Vista and Windows Server 2008 Monitoring clients as of Windows Vista and servers Windows Server 2008). The strength and accuracy of the monitoring of the risk situation must be adjusted. The way of monitoring can only be specified in the specific case. In general, the activities of administrators should also be recorded by the monitoring. In addition, a regular check is recommended so that any gaps that may arise as a result of changes in the system are uncovered.
* From a security point of view, changes in the domain structure are also critical. Therefore, these are only to be carried out after careful planning. It has to be taken into account already during the initial planning that a Windows domain structure (division into domains, trees, forests) subsequently only allows a few changes (see M .2.229 Planning of the Active Directory).
* From a security point of view it is also important to document all guidelines, regulations and processes concerning the operation of a Windows client system. Operating manuals should be created for this, which have to be updated during system changes. Since the operating manuals contain safety-relevant information, they must be stored in such a way that, on the one hand, unauthorized persons can not gain access to them, but on the other hand, authorized access by authorized administrators is easy.


The listed recommendations can only be of a general nature, since the maintenance of system security also depends on local conditions. Therefore, in the planning phase of a Windows network, appropriate guidelines for secure operation must be created, which take account of local requirements. Under certain circumstances, it may happen that certain security mechanisms can not be optimally configured safely. This is the case, for example, when old applications that are designed only for weak or no authentication need to continue to be operated. In this case, satisfactory countermeasures elsewhere or on an organizational level must guarantee satisfactory security.

The security of a Windows system during operation depends largely on the level of knowledge of the administrators. Therefore, training and education of system administrators is an important safeguard (see also M 3.27 Active Directory Management Training), as potential security vulnerabilities can only be detected and avoided by competent administrators. In addition, normal users must also be trained in security aspects (see also M 3.28 Training on security mechanisms for users in Windows client operating systems) so that potential threats are known and available security mechanisms can be used correctly ,



