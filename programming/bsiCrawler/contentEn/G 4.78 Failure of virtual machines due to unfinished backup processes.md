#G 4.78 Failure of virtual machines due to unfinished backup processes
Classic backup methods are based on agents installed on the IT systems to be backed up. These agents transfer the data to be backed up from the IT system to the backup server. He in turn forwards the data to the backup devices.

With the introduction of storage networks, IT systems and the mass storage they use can be decoupled. This means that the data backup can no longer be transmitted from the IT system to be backed up, but from the storage network to the backup server. For some storage network products, the backup devices themselves are components of the storage network and are only controlled by the backup server. This relieves the security of the IT system and the backup server from transporting the backup data.

This concept is replicated and extended by some virtualization products. For example, the virtualization servers can make the storage of virtual IT systems (virtual hard disks) available to a backup system so that this backup system can back up the data stored on the mass storage. It is necessary for this virtual disk to be in a consistent state so that inconsistent data does not get into the backup. To achieve this, the content of the virtual disk is frozen (snapshot). This process is completely transparent to the secured virtual IT system. Since the virtual IT system to be backed up continues to run and changes continue to be made to this hard disk, these changes are written to a difference file. This increases the total space required by this IT system. The size of this difference file depends on how many changes occur in the file system of the virtual IT system during the duration of the backup. When the backup is finished, the changes that have occurred in the meantime are applied to the frozen state and the difference file is deleted.

If a backup in the virtualization environment is not fully executed due to a long runtime of the backup process or communication problems in the network, the difference file that was created when the snapshot was created can become very large. It may persist permanently if the backup process unexpectedly stops. This can mean that the storage space in which the virtual disks of the virtual machines to be backed up are fully utilized, in particular if several virtual IT systems are simultaneously backed up in this way.

When the space used for the difference file mentioned above is exhausted, the virtualization server denies the virtual IT system further write access to the virtual disk, and the virtual IT system gets into an error situation. This can lead to a crash of the virtual IT system if the operating system can not compensate for this error situation.



