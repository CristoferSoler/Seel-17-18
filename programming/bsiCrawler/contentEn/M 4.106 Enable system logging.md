#M 4.106 Enable system logging
Responsible for initiation: IT security officer, IT manager

Responsible for implementation: Administrator

The native Unix syslog logging is used to capture information generated by the operating system or application processes. Security-relevant events, such as attempting to log on or executing the su command, should be logged and made available to a later evaluation.

The required syslogd daemon is usually started automatically and configured through the /etc/syslog.conf file. Appropriate rights management must ensure that only system administrators can modify this file and that the log files in / var / log and / var / adm can only be read by system administrators. All changes to /etc/syslog.conf must be documented. When adapting to the existing IT system, everything should first be logged, after which individual areas can be deactivated step by step, if necessary. Sufficient sizing of the / var partition ensures that sufficient space is available for the log files. The following example for a configuration file was created based on a SunOS configuration and defines detailed logging in different files.

#ident @ (#) syslog.conf 1.3 93/12/09 SMI / * SunOS 5.0 * / ## All messages are sent to a loghost, which must be defined in the file # / etc / hosts. ## It must be TAB to be used as a separator! ## Test:. Start syslogd with the option -d #. Start syslogd with kill -HUP after every change of this file #. the logfile must already exist before the start / restart #. with / usr / ucb / logger, test messages can be generated for each facility # and priority # *. err; kern.warning; auth.err; daemon.err /dev/console*.alert;kern.err; daemon .err operator * .alert root # displays emerg messages on terminals (uses WALL) *. emerg * # kern.info ifdef (`LOGHOST ', / var / log / kernlog, @loghost) user.info ifdef (` LOGHOST ', / var / log / userlog, @loghost) mail.info ifdef (`LOGHOST', / var / log / maillog, @loghost) daemon.info ifdef (` LOGHOST ', / var / log / daemonlog, @loghost) auth.info ifdef (`LOGHOST ', / var / log / authlog, @loghost) lpr.info ifdef (` LOGHOST', / var / log / lprlog, @loghost) news, uucp.info ifdef (`LOGHOST ', / var / log / newslog, @loghost) cron.info ifdef (`LOGHOST ', / var / log / cronlog, @loghost) ### all other local messages, for own programmelocal0, local1.info ifdef (` LOGHOST' , / var / log / locallog, @loghost) local2, local3, local4.info ifdef (`LOGHOST ', / var / log / locallog, @loghost) local5, local6, local7.info ifdef (` LOGHOST', / var / log / locallog, @loghost) ## all alarms and higher will be in e written in separate file: *. err ifdef (`LOGHOST ', / var / log / alertlog, @loghost) ## Example Log levels: # ------------------- ----------------- # 'su root' failed for .. auth.err # ROOT LOGIN REFUSED ON ... auth.err # 'su root' succeeded for .. auth .Notice



