#M 4.81 Audit and logging of activities in the network
Responsible for initiation: IT security officer, IT manager

Responsible for implementation: administrator, auditor

Proper implementation of logging, auditing and auditing is a key factor in network security.

Logging within a network management system or at certain active network components makes it possible to store certain (generally to be defined) states for a later evaluation. Typical cases that may be logged include z. the transmitted faulty packets to a network component, unauthorized access to a network component, or the performance of a network at specific times. For example, an evaluation of such protocols with suitable tools allows a conclusion as to whether the bandwidth of the network meets the current requirements, or the detection of systematic attacks on the network.

An audit is understood to mean the use of a service which, in particular, considers security-critical events. This can be done online or offline. During an online audit, the events are viewed and evaluated in real time using a tool (eg a network management system). During an offline audit, the data is logged or extracted from an existing log file. The factors monitored with the help of an offline audit often also include data on times of use and costs incurred.

During the audit, the data collected during the (offline) audit are checked by one or more independent staff (the four-eyes principle) to detect irregularities in the operation of the IT systems and the work of the administrators to control.

The logging and audit functions possible with a network management system must be activated to a reasonable extent. In addition to performance measurements for monitoring the network load, the events (events) generated by a network management system, or specific data collectors (eg RMON probes) are used to monitor and monitor safety-critical events can be evaluated.

During logging, many entries are usually made, so that they can only be meaningfully evaluated with the help of a tool. The audit focuses on the monitoring of safety-critical events. In addition, the audit frequently also collects data on periods of use and costs incurred.

In particular, the following events are of interest for an audit:

* Data on the service life of IT systems (when was which IT system switched on or off?),
* Accesses to active network components (who logged in when?),
* safety-critical access to network components and network management components with or without success,
* Distribution of the network load over the operating time of a day or a month and the general performance of the network.


Furthermore, the following events should be logged:

* Hardware malfunctions that can lead to a failure of an IT system,
* Inadmissible changes of the IP address of an IT system (in a TCP / IP environment).


An audit can be operated both online and offline. In the case of an online audit, categorized events are reported directly to the auditor, who can take action immediately if necessary. However, events must be categorized into appropriate categories so that the responsible administrator or auditor can instantly respond to important events rather than lose track of the flow of information. Is role separation necessary? During an offline audit, the data from the log files or special audit files is prepared by means of a tool for audit purposes and checked by the auditor. In the latter case, measures to maintain or restore security can only be initiated with a time delay. In general, a mix of online and offline auditing is recommended. In the process, the security-critical events are filtered for the online audit and immediately brought to the attention of the auditor. In addition, less critical events are evaluated offline.

For logging and audit, the standard management protocols, such as. SNMP and the RMON based on it, but also specific protocols of the network management products used.

Under no circumstances should user passwords be collected as part of an audit or logging! This creates a high security risk if unauthorized access to this information occurs. Even wrongly entered passwords should not be logged, since they usually differ from the valid passwords only by one character or by an exchange of two characters.

It still has to be determined who will evaluate the logs and audit data. In this case, an appropriate separation between event originator and evaluator (eg administrator and auditor) must be made. Furthermore, it must be ensured that the data protection regulations are adhered to. For all data collected, in particular the earmarking according to   14BDSG must be observed.

The log or audit files must be evaluated regularly. They can become very extensive very quickly. In order to limit the log or audit files to an evaluable measure, the evaluation intervals should therefore be selected appropriately, but nevertheless so short that a meaningful evaluation is possible.



