#M 4.49 Securing the boot process for a Windows system
Responsible for initiation: IT security officer, IT manager

Responsible for implementation: Administrator

Windows can only be operated safely if it is guaranteed from the start of the system that a closed security environment will be established. There must be no way around the security features of the operating system. This requires that all Windows-protectable resources be under the control of the operating system. In addition, there should be no way to launch foreign systems or open system environments from floppy disks, CD-ROM drives, or USB storage devices that may violate Windows protection. The following aspects should be considered:

* All existing hard disk partitions must be formatted with the NTFS file system. Partitions formatted with the file systems FAT12, FAT16, FAT32, VFAT, or HPFS can not be protected against unauthorized access by users. This means, on the one hand, that the data stored on them is exposed to any access by all users. On the other hand, these partitions can be misused for uncontrolled data exchange between users.
* Floppy disk drives pose a similar risk because diskettes under NT-based Windows systems can only be formatted with the FAT or VFAT file system. For this reason, floppy disk drives must always be locked on all computers that are not under strict physical control (see S 4.4 Suitable Handling of Drives for Removable Media and External Data Storage). On NT-based Windows clients, the floppy disk drives can also be disabled by using the Control Panel or Computer Management | Control Panel Device Manager, Device Floppy, will be disabled for unprivileged users. This should be waived on clients starting from Windows Vista (M 4.339 preventing unauthorized use of removable media from Windows Vista).
* If the computer has an open floppy drive or if it is possible to boot from an existing CD / DVD drive, there is a risk that the computer will be started with a non-Windows operating system. The same risk arises if the computer can be started from a USB storage medium or other operating systems are installed on a local hard disk. Then the user can bypass the security mechanisms of Windows with different programs. There are now several programs that allow files protected by NTFS to be read and sometimes modified by a DOS environment or a Linux environment. Both under the MS-DOS operating system and under the Linux operating system, the security attributes set by the NTFS file system are ignored. The user therefore has access to all the files on the computer from MS-DOS or Linux. For this reason, it is recommended that you do not install other operating systems on local hard drives besides Windows.
* Windows 8 or later (32-bit and 64-bit) clients support UEFI Secure Boot booting protection on devices running the Unified Extensible Firmware Interface (UEFI). This checks the bootloader's integrity before starting the OS, and possibly prevents the start of malicious software. On systems with UEFI firmware, UEFI Secure Boot must be used to secure the operating system startup. The preinstalled keys should be checked beforehand. If an untrusted key is found, then after a risk analysis, the decision must be made as to whether key management for UEFI Secure Boot itself must be undertaken. This decision should be documented.
* As part of a new installation of Windows, it is possible to update the existing installation of the operating system or to install a new version in parallel. During the parallel installation, the existing file structure is not changed, but the predefined administrator account is created with a new password. This new administrator has full access to all resources of the computer and thus to all data and programs. So that no alternative operating systems can be inserted in the boot menu of the operating system, users may not be able to change the file boot.ini in the root directory of the first disk. To prevent the booting of an alternative operating system via a boot manager on an external medium such as a USB stick or CD / DVD, the boot order must not be changed. To protect the boot order, a BIOS password should be set. (see S 4.149 File and share authorizations under Windows and M 4.247 Restrictive authorization assignment for client operating systems as of Windows Vista).
* With the help of the installation programs, an emergency diskette (see S 6.77 Creation of Rescue Diskettes for Windows 2000) for Windows 2000 can also be generated and used to perform a system reconstruction. This removes the access protection of the NTFS partition of the operating system. For this reason, it is absolutely necessary to keep the installation programs, any existing emergency floppy disk and the setup diskettes in such a way that they are protected against unauthorized access. Protection against this specific threat is also ensured by the backup of the floppy disk drives (see S 4.4 Suitable Handling of Drives for Removable Media and External Data Storage) and the protection of the boot process by appropriate settings in the BIOS (see above).
* System Reconstruction uses the Recovery Console on Windows XP clients. The route via the emergency disk is no longer available. The recovery console can be started from either the installation CD / DVD or the installation disks. It can also be integrated into the system so that it is offered as one of the boot options at system startup.
* Because the Recovery Console is a powerful tool, its use must be limited by setting the BIOS accordingly, and generally by defining the Recovery Console policies (see S 4.244 Secure System Configuration of Windows Client Operating Systems).




