#M 5.164 Secure use of a terminal server from a remote network
Responsible for initiation: IT security officer, IT manager

Responsible for implementation: Administrator

If terminal servers and their clients connect via an insecure network, it is primarily important to ensure effective network gate protection through security gateways. In addition, precautions must be taken so that the communication can not be overheard, altered or disturbed. The further procedure depends on the selection of the following differentiated connection types.

Some terminal server systems offer in-protocol encryption. In the standard configuration, however, this is usually designed for the requirements in local networks. As a result, small key lengths are usually preset, which could be sufficient in a controllable network. Frequently, bidirectional encryption between the terminal and the terminal server in favor of a resource-saving connection is also dispensed with here. Only the user input, but not the screen output returned by the server, is then encrypted. In addition, further data streams (virtual channels), for example for the connection of local data carriers, interfaces or printers of the client, can be embedded in an unencrypted manner within the protocol.

In order to protect the communication over an insecure network, it is therefore necessary to first check which cryptographic procedures and key sequences are used in the configuration to be operated and to which elements of the communication the encryption is applied. Secure communication can only be ensured if the entire data stream, including the authentication, is secured in the sender and receiver direction. Suitable methods of internally encrypted encryption currently use Secure Socket Layer (SSL) or Transport Layer Security (TLS) with at least 128 bit key length.

Both the settings of the server and those of the client are to be considered in the consideration. In this case, the settings of the server and those of the client must be reconciled in order to administratively enforce a secure connection.

If, as with the X-Window system, no internal encryption mechanisms are available, the connection can also be secured by a cryptographically secured tunnel. For the X-Window system, the X11 forwarding method using Secure Shell (M 5.64 Secure Shell) has become established. Furthermore, NX offers a modified alternative to the X11 protocol, which enables secure authentication and encrypted transport of terminal server sessions with X Window, RDP and VNC.

To protect terminal server sessions, a virtual private network (VPN) can also be used (see also B 4.4 VPN). The advantage of this approach is the automatic encapsulation of all elements of the data stream through the VPN. In this case, a further analysis of the security of the terminal server protocol can be dispensed with, since a secure login and encryption by the VPN is guaranteed.

However, when using a VPN, it should be noted that the remote client's access may extend to services other than the terminal server. Furthermore, protocol-internal procedures are optimized for the technical features of the respective terminal server environment and can therefore generally use the available bandwidth more efficiently than virtual private networks.

In addition to the protection of the perimeter area and the transmission path, the relevant client systems must be taken into account. In particular, accesses via computers in public areas, such as Internet cafes, represent a high security risk since information such as the login name and the password can possibly be read by third parties. Even mobile IT systems and stationary teleworkers are difficult to control and may deviate from their originally authorized software version.

Therefore, particularly high demands on the registration process are to be made, if the access is to be allowed over insecure Clients. In this scenario, at least one two-factor authentication could be used. During the authorization process z. B. in addition to the user name and password, a single valid identifier, also called one-time password (OTP), is required. This identifier can be generated by a mobile device (token). The possession of the device and the knowledge of username and password are hereby complementary security features that counteract the misuse of a one-time detected user login. Particularly in the case in which services of the terminal server can be accessed via portal solutions, such as via a web interface via the Internet, a two-factor authentication should be considered.

In addition, it makes sense to introduce gradations in the authorization concept for access to the various possible information channels, depending on the security of the client. Publicly accessible IT systems should be denied file sharing between terminal server and terminal as well as access to interfaces. In addition, users should not be allowed to transfer contents of the clipboard of the server to the client.

Various Terminal Server solutions provide an analysis of the client during the login process. Here, the hardware and software status as well as the timeliness of the virus protection is queried and compared with the stored guidelines. In this way, a technical measure can be used to distinguish between secure and insecure clients.



