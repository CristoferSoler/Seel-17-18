#M 4.399 Controlled integration of data and content in web applications
Responsible for initiation: IT security officer, IT manager

Responsible for implementation: Developer, Administrator

A web application creates web pages at runtime whose contents can be composed of different sources. These contents are z. In the form of files dynamically embedded when creating the web page or generated by the web application. Since the user is supplied with the finished website, it is often not clear to him from which source the displayed content originated. Therefore, the web application must ensure that only intended data and content are integrated and delivered to the user.

The contents can be integrated by means of different techniques. Therefore, the following sections summarize guidance for the safe use of common techniques.



## Examples 
* The functionality should be available only to registered users.
* Uploaded files may not be stored in the root directory of the web server service. Either fixed directory structures should be specified in which folders and files can be created or stored in another context (such as in a database or a fixed path). An attacker should not be able to break out of the given context.
* The default path for storing the uploaded files must not be changed by the users.
* To protect against denial of service attacks, the file size should be limited.
* The permissions of uploaded files should be set restrictive to prevent unauthorized access. This is to prevent that uploaded files of an attacker are executed.
* An antivirus program should scan the uploaded files for malware.
* The choice of file name should be restricted as follows:
* The file name with the file extension should be limited to a fixed number of characters (eg 200 characters).
* All non-visible characters (eg control characters) and all encoded variants of these characters should be removed from the file name (eg Unicode).
* All characters with a specific meaning for interpreters should be removed (eg;:> </ /. *% $).
* If possible, only alphanumeric characters and the file extension point should be allowed.




